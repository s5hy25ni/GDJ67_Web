CREATE TABLE ROOTBOARD(
	SEQ NUMBER PRIMARY KEY,
	ID VARCHAR2(30) NOT NULL,
	TITLE VARCHAR2(100) NOT NULL,
	CONTENT VARCHAR2(1000) NOT NULL,
	REGDATE DATE NOT NULL
);
CREATE TABLE REPLYBOARD(
	SEQ CHAR(3) PRIMARY KEY,
	REF NUMBER,
	TITLE VARCHAR2(100) NOT NULL,
	REGDATE DATE NOT NULL
);
ALTER TABLE REPLYBOARD ADD CONSTRAINT REPLYBOARD_FK FOREIGN KEY(REF) REFERENCES ROOTBOARD(SEQ);
CREATE TABLE FILEBOARD(
	F_SEQ NUMBER PRIMARY KEY,
	B_SEQ NUMBER NOT NULL,
	WRITER VARCHAR2(200),
	ORIGIN_FNAME VARCHAR2(1000) NOT NULL,
	STORED_FNAME VARCHAR2(1000) NOT NULL,
	FILE_SIZE NUMBER NOT NULL,
	F_REGDATE DATE NOT NULL,
	F_DELFLAG CHAR(1) NOT NULL
);
ALTER TABLE FILEBOARD ADD CONSTRAINT FILEBOARD_FK FOREIGN KEY(B_SEQ) REFERENCES ROOTBOARD(SEQ);



-------------------------------- 쿼리 테스트

-- 상세보기
SELECT rt.SEQ, rt.ID, rt.TITLE, rt.CONTENT, rt.REGDATE, B_SEQ , ORIGIN_FNAME , STORED_FNAME , FILE_SIZE, rp.SEQ, "REF", rp.TITLE, rp.REGDATE 
	FROM ROOTBOARD rt LEFT JOIN (SELECT B_SEQ , ORIGIN_FNAME , STORED_FNAME , FILE_SIZE
									FROM FILEBOARD
									WHERE F_DELFLAG = 'N'
										AND B_SEQ = '1') f 
	ON rt.SEQ = B_SEQ LEFT JOIN (SELECT SEQ, "REF", TITLE, REGDATE 
									FROM REPLYBOARD
										WHERE "REF"='1'
										ORDER BY SEQ) rp
	ON rt.SEQ = "REF";

-- 새글작성
INSERT INTO ROOTBOARD(SEQ, ID, TITLE, 
								CONTENT, REGDATE)
					VALUES((SELECT NVL(MAX(SEQ), 0)+1 FROM ROOTBOARD), 'TEST', 'TEST TITLE 02', 
								'TEST CONTENT 02', SYSDATE);

-- 파일업로드
INSERT INTO FILEBOARD(F_SEQ, B_SEQ, WRITER, 
						ORIGIN_FNAME, STORED_FNAME, FILE_SIZE, 
						F_REGDATE, F_DELFLAG)
				VALUES((SELECT NVL(MAX(F_SEQ), 0)+1 FROM FILEBOARD), 2, 'TEST', 
						'TEST NAME 01', 'asfsfdsfaasdfsefcx', 1, 
						SYSDATE, 'N');